{% extends "base.html" %}
{% set feed_url %}{{ url_for('view_user_feed', username=user.username) }}{% endset %}
{% block title %}User {{ user.username }}{% endblock %}
{% block canonical %}{{ url_for('view_user', username=user.username) }}{% endblock %}
{% block external %}{{ user.url or "" }}{% endblock %}
{% block metadata %}
  <link rel="alternate" type="application/atom+xml" href="{{ feed_url }}" title="@{{ user.username }} Feed" />
{% endblock %}
{% block content %}
  <div class="uk-text-center">
    <h2>
      {% if user.url %}<a target="_blank" href="{{ user.url }}">{% endif %}
      {{ user.username }}
      {% if user.url %}</a>{% endif %}
    </h2>
    {% if user.data.propic %}
      {% with item=load_item(user.data.propic) %}
        <div class="uk-width-medium uk-align-center">
          {% include "item-content.html" %}
        </div>
      {% endwith %}
    {% endif %}
    <p>{{ user.data.description }}</p>
    {% if current_user.is_authenticated and current_user.username == user.username %}
      <div class="uk-margin uk-flex-center uk-grid-small uk-grid" uk-grid>
        <div>
          <a class="uk-button uk-button-default uk-icon-link" href="{{ feed_url }}" target="_blank" rel="nofollow">
            Feed (Atom) <span uk-icon="rss"></span>
          </a>
        </div>
        <div>
          <a class="uk-button uk-button-default uk-icon-link" href="{{ url_for('export_api') }}" target="_blank" rel="nofollow">
            {{ _('Export data') }} (ZIP) <span uk-icon="download"></span>
          </a>
        </div>
      </div>
    {% endif %}
  </div>
  {% if folders | length > 0 %}
    <hr />
    <div uk-grid="masonry: pack" class="results uk-grid uk-grid-small uk-child-width-1-2 uk-child-width-1-3@s uk-child-width-1-4@m uk-child-width-1-5@l uk-child-width-1-6@xl">
      {% for folder in folders %}
        <div>
          <a class="uk-link-text" href="{{ url_for('view_user', username=user.username, cid=folder.id) }}">
            <div style="font-size: 0;">
              {% for item in folder['items'] %}
                {% include 'item-content.html' %}
              {% endfor %}
            </div>
            <span class="uk-text-break">{{ folder.id }}</span>
          </a>
        </div>
      {% endfor %}
    </div>
  {% endif %}
  <hr />
  {% include 'collection.html' %}
{% endblock %}